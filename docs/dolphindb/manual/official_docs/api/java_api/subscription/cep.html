<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../../../favicon.ico"/><link rel="icon" href="../../../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="DolphinDB 在 3.00.0 版本中支持了 复杂事件处理引擎 （Complex Event Processing Engine，简称 CEP 引擎），用于实时处理和分析复杂事件数据流。CEP 引擎支持订阅异构流表，该表中的每一行数据代表着一个事件。每当异构流表中新增一行数据，CEP 引擎都会收到通知并处理该事件。为配合使用该功能，Java API 自 3.00.0.0 版本起提供 ..."/><meta name="DC.rights.owner" content="(C) 版权 2024"/><meta name="copyright" content="(C) 版权 2024"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../../../api/java_api/subscription.html"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="事件订阅"/><title>事件订阅</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../../../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20240704100525325/api/java_api/subscription?&gt;&lt;?workdir-uri file:/tmp/temp20240704100525325/api/java_api/subscription/?&gt;&lt;?path2project ../../../?&gt;&lt;?path2project-uri ../../../?&gt;&lt;?path2rootmap-uri ../../../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;事件订阅&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;事件订阅&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;DolphinDB 在 3.00.0 版本中支持了&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/stream/cep.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:1;3:26&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;?ditaot usertext?&gt;复杂事件处理引擎&lt;/xref&gt;（Complex Event Processing Engine，简称 CEP 引擎），用于实时处理和分析复杂事件数据流。CEP 引擎支持订阅异构流表，该表中的每一行数据代表着一个事件。每当异构流表中新增一行数据，CEP 引擎都会收到通知并处理该事件。为配合使用该功能，Java API 自 3.00.0.0 版本起提供 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;3:243&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventSchema&lt;/codeph&gt;, &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;3:258&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventSender&lt;/codeph&gt;和&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;3:272&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventClient&lt;/codeph&gt;，分别用于构造事件、将事件写入异构流表、以及从异构流表中订阅事件。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;本节将详细介绍这三类工具的使用，并给出一个完整的使用示例。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;将事件写入异构流表，作为服务端 CEP 引擎接收的数据源。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;8:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;订阅服务端 CEP 引擎输出的异构流表中的事件。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:100;280:86&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_connapi.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../../../api/java_api/subscription.dita&#34; mapclass=&#34;- map/topicref &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:98;277:61&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_connapi.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot gentext?&gt;订阅&lt;/linktext&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;eventschema-构造事件&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventSchema 构造事件&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;API 提供 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;12:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventSchema&lt;/codeph&gt; 工具，用于在客户端自定义事件。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:1;14:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;public class EventSchema { private String eventType; private List&amp;lt;String&amp;gt; fieldNames; private List&amp;lt;Entity.DATA_TYPE&amp;gt; fieldTypes; private List&amp;lt;Entity.DATA_FORM&amp;gt; fieldForms; private List&amp;lt;Integer&amp;gt; fieldExtraParams; }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;24:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:1;24:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;参数说明&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;26:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:2;26:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;eventType&lt;/b&gt; String 类型，表示事件。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;28:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:3;28:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;fieldNames&lt;/b&gt; String 类型，表示字段名。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;30:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:4;30:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;fieldTypes&lt;/b&gt; 表示字段数据类型。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;32:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:5;32:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;fieldForms&lt;/b&gt; 表示字段数据形式。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;34:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:6;34:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;fieldExtraParams&lt;/b&gt; 非负 int 类型，额外参数，当字段类型为 DECIMAL 时，用来指定 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:1;34:59&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;scale&lt;/i&gt;（DECIMAL 类型的特有参数，用于指定小数位数）。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;eventsender-发送事件&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventSender 发送事件&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;38:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;API 提供 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;38:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventSender&lt;/codeph&gt; 工具，用于向存储事件信息的异构流表中写入序列化后的事件数据。DolphinDB 服务端的 CEP 引擎通常会订阅这些流表，以便捕获并处理相应的事件。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;40:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;构造函数：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:2;42:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;public EventSender(DBConnection conn, String tableName, List&amp;lt;EventSchema&amp;gt; eventSchemas, List&amp;lt;String&amp;gt; eventTimeKeys, List&amp;lt;String&amp;gt; commonKeys) {&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;46:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:7;46:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;参数介绍&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;48:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:8;48:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;conn&lt;/b&gt; 表示已连接成功的 DBConnection 对象，注意该 DBConnection 不能是异步模式。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;50:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:9;50:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;tableName&lt;/b&gt; String 类型，表示要写入的异构流表的名字。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;52:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:10;52:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;eventSchemas&lt;/b&gt; 表示 CEP 引擎可以处理的所有事件结构，即可能会发送的所有事件结构。注意，事件结构必须与创建 CEP 引擎时指定的结构相同，否则无法正确处理。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;54:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:11;54:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;eventTimeFields&lt;/b&gt; 可选参数，String 类型标量或String 类型列表，用来指定事件的时间字段。如果待写入的异构流表第一列是时间类型，则须指定每个事件中的时间类型字段。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;56:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;56:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;如果所有事件中的时间字段名字相同，则该参数只需指定为一个String 类型标量。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;57:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;如果各个事件的时间字段名称不同，则该参数需要指定为一个String 类型向量。其中各元素的顺序与 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:2;57:52&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;eventSchema&lt;/i&gt; 参数的传入顺序保持一致。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;59:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:12;59:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;commonFields&lt;/b&gt; 可选参数，String 类型列表，表示事件中具有相同名称的字段。可以将事件之间相同的字段单独作为列存入流表中，以便在订阅中进行过滤。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;sendevent-发送&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;61:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;61:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:13;61:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;sendEvent 发送&lt;/b&gt;&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;61:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;63:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;将事件发送至 DolphinDB 服务端。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:3;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;public void sendEvent(String eventType, List&amp;lt;Entity&amp;gt; attributes)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:14;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;参数说明&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:20;71:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:15;71:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;eventType&lt;/b&gt; String 类型，表示事件。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:21;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:16;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;attributes&lt;/b&gt; 表示事件中各成员的值。注意，传入值的顺序必须与定义 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;73:42&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventSchema&lt;/codeph&gt; 结构时指定的字段顺序相同，且其数据类型和数据形式也须与之匹配。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;eventclient-订阅事件&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventClient 订阅事件&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:22;77:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;API 提供 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;77:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventClient&lt;/codeph&gt; 工具，用于订阅异构流表中事件。该异构流表通常接收 DolphinDB 服务端 CEP 引擎处理后并序列化输出的事件数据。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:23;79:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;其构造方法如下，其参数与 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;79:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventSender&lt;/codeph&gt; 构造函数的相同：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:4;81:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;public EventClient(List&amp;lt;EventSchema&amp;gt; eventSchemas, List&amp;lt;String&amp;gt; eventTimeKeys, List&amp;lt;String&amp;gt; commonKeys)&lt;/codeblock&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;subscribe-订阅&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;85:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;85:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:17;85:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;subscribe 订阅&lt;/b&gt;&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;85:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:5;87:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;public void subscribe(String host, int port, String tableName, String actionName, MessageHandler handler, long offset, boolean reconnect, String userName, String password)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:24;91:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:18;91:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;参数说明&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:25;93:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:19;93:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;host&lt;/b&gt; String 类型，表示发布端节点的 IP 地址。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:26;95:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:20;95:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;port&lt;/b&gt; String 类型，表示发布端节点的端口号。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:27;97:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:21;97:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;tableName&lt;/b&gt; String 类型，表示异构流表的的名称。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:28;99:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:22;99:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;actionName&lt;/b&gt; 可选参数，String 类型，表示订阅任务的名称，默认为 ”javaStreamingApi” 。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:29;101:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:23;101:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;handler&lt;/b&gt; 表示用户自定义的回调函数，用于处理每次流入的消息。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:30;103:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:24;103:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;offset&lt;/b&gt; 可选参数，int 类型，表示订阅任务开始后的第一条消息所在的位置，默认为 -1。一条消息对应流数据表中的一行。如果没有指定 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:3;103:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;offset&lt;/i&gt;，或它为负数，或超过了流数据表的记录行数，订阅将会从流数据表的当前行开始。&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:4;103:119&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;offset&lt;/i&gt; 与流数据表创建时的第一行对应。如果某些行因为内存限制被删除，在决定订阅开始的位置时，这些行仍然考虑在内。具体可参考 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/funcs/s/subscribeTable.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:2;103:186&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;?ditaot usertext?&gt;DolphinDB 文档- subscribe&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:31;105:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:25;105:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;reconnect&lt;/b&gt; 可选参数，boolean 类型，表示订阅中断后是否会自动重订阅，默认为 false，表示不订阅。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:32;107:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:26;107:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;user&lt;/b&gt; 可选参数，String 类型，表示 Java API 所连接服务器的登录用户名，默认为 “” 表示空String 类型。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:33;109:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:27;109:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;password&lt;/b&gt; 可选参数，String 类型，表示 Java API 所连接服务器的登录密码，默认为“” 表示空String 类型。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:34;111:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:28;111:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;回调函数使用说明&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:35;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;使用时，第一个参数表示事件名称，第二个参数就是各个成员的值。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:6;115:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventMessageHandler handler = new EventMessageHandler() { @Override public void doEvent(String eventType, List&amp;lt;Entity&amp;gt; attribute) { // 处理逻辑 } };&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;unsubscribe-取消订阅&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;124:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;124:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:29;124:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;unsubscribe 取消订阅&lt;/b&gt;&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;124:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:7;126:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;public void unsubscribe(String host, int port, String tableName, String actionName)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:36;130:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:30;130:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;参数说明&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:37;132:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:31;132:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;host&lt;/b&gt; String 类型，表示发布端节点的 IP 地址。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:38;134:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:32;134:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;port&lt;/b&gt; int 类型，表示发布端节点的端口号。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:39;136:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:33;136:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;tableName&lt;/b&gt; String 类型，表示异构流表名。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:40;138:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:34;138:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;actionName&lt;/b&gt; String 类型，表示任务名称。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;使用示例&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;140:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;140:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;使用示例&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;140:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:41;142:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;本例将先介绍在 server 端创建事件、用于序列化事件的接口、分别用于写入和写出的异构流表、以及处理事件的 CEP 引擎；然后在 API 端使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;142:75&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventSender&lt;/codeph&gt; 向异构流表发送事件；当 CEP 引擎通过订阅接收并处理完数据后会向另一个异构流表输出消息， API 端再使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;142:144&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventClient&lt;/codeph&gt; 从该表订阅输出的事件。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:42;144:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:35;144:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;Server 端创建基本要素&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:43;146:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;下述脚本将在 DolphinDB 服务端创建两个异构流表 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:5;146:30&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;input&lt;/i&gt; 和 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:6;146:40&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;output&lt;/i&gt;，两个 streamEventSerializer（&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/stream/serialize_and_deserialize.html?hl=streameventserializer&#34; scope=&#34;external&#34; xtrc=&#34;xref:3;146:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;?ditaot usertext?&gt;序列化接口&lt;/xref&gt;），一个 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/stream/cep_engine.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:4;146:179&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;?ditaot usertext?&gt;CEP 引擎&lt;/xref&gt;，以及一个 MarketData &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/stream/cep_intro.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:5;146:257&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;?ditaot usertext?&gt;事件&lt;/xref&gt;。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:8;148:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;login(&#34;admin&#34;,&#34;123456&#34;); class MarketData{ market :: STRING code :: STRING price :: DOUBLE qty :: INT eventTime :: TIMESTAMP def MarketData(m,c,p,q){ market = m code = c price = p qty = q eventTime = now() } } class MainMonitor{ def MainMonitor(){ } def updateMarketData(event) def onload(){ addEventListener(updateMarketData,'MarketData',,'all') } def updateMarketData(event){ emitEvent(event) } } dummy = table(array(TIMESTAMP, 0) as eventTime, array(STRING, 0) as eventType, array(BLOB, 0) as blobs) share streamTable(array(TIMESTAMP, 0) as eventTime, array(STRING, 0) as eventType, array(BLOB, 0) as blobs) as intput share streamTable(array(TIMESTAMP, 0) as eventTime, array(STRING, 0) as eventType, array(BLOB, 0) as blobs) as output schema = table(1:0, `eventType`eventKeys`eventValuesTypeString`eventValueTypeID`eventValuesFormID, [STRING, STRING, STRING, INT[], INT[]]) insert into schema values(&#34;MarketData&#34;, &#34;market,code,price,qty,eventTime&#34;, &#34;STRING,STRING,DOUBLE,INT,TIMESTAMP&#34;, [18 18 16 4 12], [0 0 0 0 0]) inputSerializer = streamEventSerializer(name=`serInput, eventSchemes=schema, outputTable=intput, eventTimeKey = &#34;eventTime&#34;) outputSerializer = streamEventSerializer(name=`serOutput, eventSchemes=schema, outputTable=output, eventTimeKey = &#34;eventTime&#34;) engine = createCEPEngine('cep1', &amp;lt;MainMonitor()&amp;gt;, dummy, [MarketData], 1, 'eventTime', 10000, outputSerializer) subscribeTable(,`intput, `subopt, 0, getStreamEngine('cep1'),true) marketData1 = MarketData('sz', 's001', 9.8, 100) marketData2 = MarketData('sz', 's002', 6.9, 100) marketData3 = MarketData('sz', 's003', 4.8, 100) marketData4 = MarketData('sz', 's004', 9.8, 100) marketData5 = MarketData('sz', 's005', 9.8, 100) appendEvent(inputSerializer, [marketData1,marketData2,marketData3,marketData4,marketData5])&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:44;200:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;API 端使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;200:9&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventSender&lt;/codeph&gt; 向 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:7;200:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:36;200:26&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;input&lt;/b&gt;&lt;/i&gt; 表写入数据。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:9;202:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;// 定义 schema EventSchema schema = new EventSchema(); schema.setEventType(&#34;MarketData&#34;); schema.setFieldNames(Arrays.asList(&#34;market&#34;, &#34;code&#34;, &#34;price&#34;, &#34;qty&#34;, &#34;eventTime&#34;)); schema.setFieldTypes(Arrays.asList(DT_STRING, DT_STRING, DT_DOUBLE, DT_INT, DT_TIMESTAMP)); schema.setFieldForms(Arrays.asList(DF_SCALAR, DF_SCALAR, DF_SCALAR, DF_SCALAR, DF_SCALAR)); List&amp;lt;EventSchema&amp;gt; eventSchemas = Collections.singletonList(scheme); List&amp;lt;String&amp;gt; eventTimeKeys = Collections.singletonList(&#34;eventTime&#34;); List&amp;lt;String&amp;gt; commonKeys = new ArrayList&amp;lt;&amp;gt;(); // 创建 EventSender DBConnection conn = new DBConnection(); conn.connect(HOST, PORT, &#34;admin&#34;, &#34;123456&#34;); EventSender sender = new EventSender(conn, &#34;input&#34;, eventSchemas, eventTimeKeys, commonKeys); // 准备数据： List&amp;lt;Entity&amp;gt; attributes = new ArrayList&amp;lt;&amp;gt;(); attributes.add(new BasicString(&#34;sz&#34;)); attributes.add(new BasicString(&#34;s001&#34;)); attributes.add(new BasicDouble(9.8)); attributes.add(new BasicInt(100)); attributes.add(new BasicTimestamp(LocalDateTime.of(2024,3,13,15,11,10,630))); sender.sendEvent(&#34;MarketData&#34;, attributes);&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:45;229:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;CEP 引擎会去订阅 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:8;229:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;input&lt;/i&gt; 流表，在收到消息后，将消息输出到 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:9;229:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;output&lt;/i&gt; 流表。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:46;231:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;API 端使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;231:9&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventClient&lt;/codeph&gt; 订阅 output 表。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:10;233:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/cep.md&#34;&gt;EventSchema scheme = new EventSchema(); scheme.setEventType(&#34;MarketData&#34;); scheme.setFieldNames(Arrays.asList(&#34;market&#34;, &#34;code&#34;, &#34;price&#34;, &#34;qty&#34;, &#34;eventTime&#34;)); scheme.setFieldTypes(Arrays.asList(DT_STRING, DT_STRING, DT_DOUBLE, DT_INT, DT_TIMESTAMP)); scheme.setFieldForms(Arrays.asList(DF_SCALAR, DF_SCALAR, DF_SCALAR, DF_SCALAR, DF_SCALAR)); List&amp;lt;EventSchema&amp;gt; eventSchemas = Collections.singletonList(scheme); List&amp;lt;String&amp;gt; eventTimeKeys = Collections.singletonList(&#34;eventTime&#34;); List&amp;lt;String&amp;gt; commonKeys = new ArrayList&amp;lt;&amp;gt;(); // 自定义的回调函数 EventMessageHandler handler = new EventMessageHandler() { @Override public void doEvent(String eventType, List&amp;lt;Entity&amp;gt; attribute) { // 自定义处理数据 System.out.println(&#34;eventType: &#34; + eventType); for (Entity entity : attribute) { System.out.println(entity.getString()); } System.out.println(&#34;\n&#34;); } }; // 创建事件订阅类 EventClient client = new EventClient(eventSchemas, eventTimeKeys, commonKeys); // 订阅 client.subscribe(HOST, PORT, &#34;output&#34;, &#34;ss1&#34;, handler, 0, true, &#34;admin&#34;, &#34;123456&#34;); Thread.sleep(10000); // 取消订阅 client.unsubscribe(HOST, PORT, &#34;output&#34;, &#34;ss1&#34;);&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="api/java_api/subscription/cep.md"/><meta name="wh-out-relpath" content="api/java_api/subscription/cep.html"/>

    <link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../../../oxygen-webhelp/app/options/properties.js?buildId=20240704100525"></script>
    <script src="../../../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../../../oxygen-webhelp/app/search/index/keywords.js?buildId=20240704100525"></script>
    <script defer="defer" src="../../../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../../../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="事件订阅" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://www.dolphindb.cn" class=" wh_logo d-none d-sm-block "><img src="../../../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../../../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../../../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>

            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../../../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="api_protocol"><div class="title"><a href="../../../api/connapi_intro.html"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li><div class="topicref" data-id="javaapi_landingpage"><div class="title"><a href="../../../api/java_api/newjava.html">Java API</a></div></div></li><li><div class="topicref" data-id="subscription"><div class="title"><a href="../../../api/java_api/subscription.html">订阅</a></div></div></li><li class="active"><div class="topicref" data-id="事件订阅"><div class="title"><a href="../../../api/java_api/subscription/cep.html">事件订阅</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="new_chap_about_sect_ddb_docs_intro-d9529e87" class="topicref" data-id="new_chap_about_sect_ddb_docs_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../about/ddb_docs_intro.html" id="new_chap_about_sect_ddb_docs_intro-d9529e87-link">文档使用说明</a><div class="wh-tooltip"><p class="shortdesc">如何获取 DolphinDB 帮助信息</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap1_getstarted-d9529e140" class="topicref" data-id="chap1_getstarted" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap1_getstarted-d9529e140-link" class="wh-expand-btn"></span><div class="title"><a href="../../../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9529e140-link"><span class="keyword label">快速上手</span></a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9529e335" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9529e335-link" class="wh-expand-btn"></span><div class="title"><a href="../../../deploy/deploy_intro.html" id="sectionddb_deployment-d9529e335-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9529e2313" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9529e2313-link" class="wh-expand-btn"></span><div class="title"><a href="../../../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9529e2313-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9529e3490" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9529e3490-link" class="wh-expand-btn"></span><div class="title"><a href="../../../stream/str_intro.html" id="chap7_tutorials_streaming-d9529e3490-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9529e7385" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9529e7385-link" class="wh-expand-btn"></span><div class="title"><a href="../../../db_distr_comp/db_oper/import_data.html" id="tocId-d9529e7385-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9529e7812" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9529e7812-link" class="wh-expand-btn"></span><div class="title"><a href="../../../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9529e7812-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9529e16490" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9529e16490-link" class="wh-expand-btn"></span><div class="title"><a href="../../../progr/progr_intro.html" id="about_language_resources-d9529e16490-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9529e26503" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9529e26503-link" class="wh-expand-btn"></span><div class="title"><a href="../../../funcs/funcs_intro.html" id="functions_references-d9529e26503-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="api_protocol-d9529e86456" class="topicref" data-id="api_protocol" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action api_protocol-d9529e86456-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/connapi_intro.html" id="api_protocol-d9529e86456-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="cpp_api-d9529e86509" class="topicref" data-id="cpp_api" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action cpp_api-d9529e86509-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/cpp/cpp_api.html" id="cpp_api-d9529e86509-link">C++ API</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap5_sectpythonapi-d9529e88349" class="topicref" data-id="chap5_sectpythonapi" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap5_sectpythonapi-d9529e88349-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/python/py.html" id="chap5_sectpythonapi-d9529e88349-link"><span class="keyword label">Python API</span></a></div></div></li><li role="treeitem"><div data-tocid="c-api-d9529e90273" class="topicref" data-id="c-api" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/csharp.html" id="c-api-d9529e90273-link">C# API</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="javaapi_landingpage-d9529e90319" class="topicref" data-id="javaapi_landingpage" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action javaapi_landingpage-d9529e90319-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/newjava.html" id="javaapi_landingpage-d9529e90319-link">Java API</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="安装-d9529e90365" class="topicref" data-id="安装" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/install.html" id="安装-d9529e90365-link">安装</a></div></div></li><li role="treeitem"><div data-tocid="快速开始-d9529e90411" class="topicref" data-id="快速开始" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/quickstart.html" id="快速开始-d9529e90411-link">快速开始</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_datatypes_forms-d9529e90457" class="topicref" data-id="java_api_datatypes_forms" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_datatypes_forms-d9529e90457-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_data_types_forms.html" id="java_api_datatypes_forms-d9529e90457-link">数据类型与形式</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_basic_ops-d9529e90641" class="topicref" data-id="java_api_basic_ops" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_basic_ops-d9529e90641-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_con_ops.html" id="java_api_basic_ops-d9529e90641-link">连接相关</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_landingpage-d9529e90917" class="topicref" data-id="java_api_landingpage" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_landingpage-d9529e90917-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_conpool.html" id="java_api_landingpage-d9529e90917-link">连接池</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="subscription-d9529e91055" class="topicref" data-id="subscription" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action subscription-d9529e91055-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/subscription.html" id="subscription-d9529e91055-link">订阅</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="流订阅-d9529e91101" class="topicref" data-id="流订阅" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/subscription/StreamingDataSubscription.html" id="流订阅-d9529e91101-link">流订阅</a></div></div></li><li role="treeitem" class="active"><div data-tocid="事件订阅-d9529e91147" class="topicref" data-id="事件订阅" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/subscription/cep.html" id="事件订阅-d9529e91147-link">事件订阅</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_write_data-d9529e91193" class="topicref" data-id="java_api_write_data" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_write_data-d9529e91193-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_write_data.html" id="java_api_write_data-d9529e91193-link">数据写入</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_troubleshooting-d9529e91469" class="topicref" data-id="java_api_troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_troubleshooting-d9529e91469-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_troubleshooting.html" id="java_api_troubleshooting-d9529e91469-link">FAQ</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_appendix-d9529e91653" class="topicref" data-id="java_api_appendix" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_appendix-d9529e91653-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_attachment.html" id="java_api_appendix-d9529e91653-link">附录</a></div></div></li></ul></li><li role="treeitem"><div data-tocid="jdbc-连接器-d9529e91745" class="topicref" data-id="jdbc-连接器" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/jdbc.html" id="jdbc-连接器-d9529e91745-link">JDBC 连接器</a></div></div></li><li role="treeitem"><div data-tocid="go-api-d9529e91791" class="topicref" data-id="go-api" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/go.html" id="go-api-d9529e91791-link">Go API</a></div></div></li><li role="treeitem"><div data-tocid="javascript-api-d9529e91837" class="topicref" data-id="javascript-api" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/js.html" id="javascript-api-d9529e91837-link">JavaScript API</a></div></div></li><li role="treeitem"><div data-tocid="json-api-d9529e91883" class="topicref" data-id="json-api" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/json.html" id="json-api-d9529e91883-link">JSON API</a></div></div></li><li role="treeitem"><div data-tocid="r-api-d9529e91929" class="topicref" data-id="r-api" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/r.html" id="r-api-d9529e91929-link">R API</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap6_plugin-d9529e91976" class="topicref" data-id="chap6_plugin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap6_plugin-d9529e91976-link" class="wh-expand-btn"></span><div class="title"><a href="../../../plugins/plg_intro.html" id="chap6_plugin-d9529e91976-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9529e94749" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9529e94749-link" class="wh-expand-btn"></span><div class="title"><a href="../../../third_party.html" id="third_party-d9529e94749-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_tutorials-d9529e94980" class="topicref" data-id="about_tutorials" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_tutorials-d9529e94980-link" class="wh-expand-btn"></span><div class="title"><a href="../../../tutorials/about_tutorials.html" id="about_tutorials-d9529e94980-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9529e101769" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9529e101769-link" class="wh-expand-btn"></span><div class="title"><a href="../../../rn/server/3_00_1.html" id="tocId-d9529e101769-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">事件订阅</h1><div class="- topic/body body"><p class="- topic/p p">DolphinDB 在 3.00.0 版本中支持了<a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/stream/cep.html" target="_blank" rel="external noopener">复杂事件处理引擎</a>（Complex Event Processing Engine，简称 CEP 引擎），用于实时处理和分析复杂事件数据流。CEP 引擎支持订阅异构流表，该表中的每一行数据代表着一个事件。每当异构流表中新增一行数据，CEP 引擎都会收到通知并处理该事件。为配合使用该功能，Java API 自 3.00.0.0 版本起提供 <code class="+ topic/ph pr-d/codeph ph codeph">EventSchema</code>, <code class="+ topic/ph pr-d/codeph ph codeph">EventSender</code>和<code class="+ topic/ph pr-d/codeph ph codeph">EventClient</code>，分别用于构造事件、将事件写入异构流表、以及从异构流表中订阅事件。</p><p class="- topic/p p">本节将详细介绍这三类工具的使用，并给出一个完整的使用示例。</p><ul class="- topic/ul ul"><li class="- topic/li li">将事件写入异构流表，作为服务端 CEP 引擎接收的数据源。</li><li class="- topic/li li">订阅服务端 CEP 引擎输出的异构流表中的事件。</li></ul></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="eventschema-构造事件"><h2 class="- topic/title title topictitle2" id="ariaid-title2">EventSchema 构造事件</h2><div class="- topic/body body"><p class="- topic/p p">API 提供 <code class="+ topic/ph pr-d/codeph ph codeph">EventSchema</code> 工具，用于在客户端自定义事件。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public class EventSchema {
  private String eventType;                         
  private List&lt;String&gt; fieldNames;                  
  private List&lt;Entity.DATA_TYPE&gt; fieldTypes;           
  private List&lt;Entity.DATA_FORM&gt; fieldForms;            
  private List&lt;Integer&gt; fieldExtraParams;              
}</code></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">参数说明</strong></p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">eventType</strong> String 类型，表示事件。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">fieldNames</strong> String 类型，表示字段名。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">fieldTypes</strong> 表示字段数据类型。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">fieldForms</strong> 表示字段数据形式。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">fieldExtraParams</strong> 非负 int 类型，额外参数，当字段类型为 DECIMAL 时，用来指定 <em class="+ topic/ph hi-d/i ph i">scale</em>（DECIMAL 类型的特有参数，用于指定小数位数）。</p></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title3" id="eventsender-发送事件"><h2 class="- topic/title title topictitle2" id="ariaid-title3">EventSender 发送事件</h2><div class="- topic/body body"><p class="- topic/p p">API 提供 <code class="+ topic/ph pr-d/codeph ph codeph">EventSender</code> 工具，用于向存储事件信息的异构流表中写入序列化后的事件数据。DolphinDB 服务端的 CEP 引擎通常会订阅这些流表，以便捕获并处理相应的事件。</p><p class="- topic/p p">构造函数：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public EventSender(DBConnection conn, String tableName, List&lt;EventSchema&gt; eventSchemas, List&lt;String&gt; eventTimeKeys, List&lt;String&gt; commonKeys) {</code></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">参数介绍</strong></p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">conn</strong> 表示已连接成功的 DBConnection 对象，注意该 DBConnection 不能是异步模式。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">tableName</strong> String 类型，表示要写入的异构流表的名字。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">eventSchemas</strong> 表示 CEP 引擎可以处理的所有事件结构，即可能会发送的所有事件结构。注意，事件结构必须与创建 CEP 引擎时指定的结构相同，否则无法正确处理。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">eventTimeFields</strong> 可选参数，String 类型标量或String 类型列表，用来指定事件的时间字段。如果待写入的异构流表第一列是时间类型，则须指定每个事件中的时间类型字段。</p><ul class="- topic/ul ul"><li class="- topic/li li">如果所有事件中的时间字段名字相同，则该参数只需指定为一个String 类型标量。</li><li class="- topic/li li">如果各个事件的时间字段名称不同，则该参数需要指定为一个String 类型向量。其中各元素的顺序与 <em class="+ topic/ph hi-d/i ph i">eventSchema</em> 参数的传入顺序保持一致。</li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">commonFields</strong> 可选参数，String 类型列表，表示事件中具有相同名称的字段。可以将事件之间相同的字段单独作为列存入流表中，以便在订阅中进行过滤。</p></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title4" id="sendevent-发送"><h3 class="- topic/title title topictitle3" id="ariaid-title4"><strong class="+ topic/ph hi-d/b ph b">sendEvent 发送</strong></h3><div class="- topic/body body"><p class="- topic/p p">将事件发送至 DolphinDB 服务端。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public void sendEvent(String eventType, List&lt;Entity&gt; attributes)</code></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">参数说明</strong></p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">eventType</strong> String 类型，表示事件。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">attributes</strong> 表示事件中各成员的值。注意，传入值的顺序必须与定义 <code class="+ topic/ph pr-d/codeph ph codeph">EventSchema</code> 结构时指定的字段顺序相同，且其数据类型和数据形式也须与之匹配。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title5" id="eventclient-订阅事件"><h2 class="- topic/title title topictitle2" id="ariaid-title5">EventClient 订阅事件</h2><div class="- topic/body body"><p class="- topic/p p">API 提供 <code class="+ topic/ph pr-d/codeph ph codeph">EventClient</code> 工具，用于订阅异构流表中事件。该异构流表通常接收 DolphinDB 服务端 CEP 引擎处理后并序列化输出的事件数据。</p><p class="- topic/p p">其构造方法如下，其参数与 <code class="+ topic/ph pr-d/codeph ph codeph">EventSender</code> 构造函数的相同：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public EventClient(List&lt;EventSchema&gt; eventSchemas, List&lt;String&gt; eventTimeKeys, List&lt;String&gt; commonKeys)</code></pre></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title6" id="subscribe-订阅"><h3 class="- topic/title title topictitle3" id="ariaid-title6"><strong class="+ topic/ph hi-d/b ph b">subscribe 订阅</strong></h3><div class="- topic/body body"><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public void subscribe(String host, int port, String tableName, String actionName, MessageHandler handler, long offset, boolean reconnect, String userName, String password)</code></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">参数说明</strong></p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">host</strong> String 类型，表示发布端节点的 IP 地址。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">port</strong> String 类型，表示发布端节点的端口号。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">tableName</strong>  String 类型，表示异构流表的的名称。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">actionName</strong> 可选参数，String 类型，表示订阅任务的名称，默认为 ”javaStreamingApi” 。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">handler</strong> 表示用户自定义的回调函数，用于处理每次流入的消息。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">offset</strong> 可选参数，int 类型，表示订阅任务开始后的第一条消息所在的位置，默认为 -1。一条消息对应流数据表中的一行。如果没有指定 <em class="+ topic/ph hi-d/i ph i">offset</em>，或它为负数，或超过了流数据表的记录行数，订阅将会从流数据表的当前行开始。<em class="+ topic/ph hi-d/i ph i">offset</em> 与流数据表创建时的第一行对应。如果某些行因为内存限制被删除，在决定订阅开始的位置时，这些行仍然考虑在内。具体可参考 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/funcs/s/subscribeTable.html" target="_blank" rel="external noopener">DolphinDB 文档- subscribe</a>。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">reconnect</strong> 可选参数，boolean 类型，表示订阅中断后是否会自动重订阅，默认为 false，表示不订阅。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">user</strong> 可选参数，String 类型，表示 Java API 所连接服务器的登录用户名，默认为 “” 表示空String 类型。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">password</strong> 可选参数，String 类型，表示 Java API 所连接服务器的登录密码，默认为“” 表示空String 类型。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">回调函数使用说明</strong></p><p class="- topic/p p">使用时，第一个参数表示事件名称，第二个参数就是各个成员的值。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>EventMessageHandler handler = new EventMessageHandler() {
    @Override
    public void doEvent(String eventType, List&lt;Entity&gt; attribute) {
        // 处理逻辑
    }
};</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title7" id="unsubscribe-取消订阅"><h3 class="- topic/title title topictitle3" id="ariaid-title7"><strong class="+ topic/ph hi-d/b ph b">unsubscribe 取消订阅</strong></h3><div class="- topic/body body"><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public void unsubscribe(String host, int port, String tableName, String actionName)</code></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">参数说明</strong></p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">host</strong> String 类型，表示发布端节点的 IP 地址。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">port</strong> int 类型，表示发布端节点的端口号。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">tableName</strong> String 类型，表示异构流表名。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">actionName</strong> String 类型，表示任务名称。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title8" id="使用示例"><h2 class="- topic/title title topictitle2" id="ariaid-title8">使用示例</h2><div class="- topic/body body"><p class="- topic/p p">本例将先介绍在 server 端创建事件、用于序列化事件的接口、分别用于写入和写出的异构流表、以及处理事件的 CEP 引擎；然后在 API 端使用 <code class="+ topic/ph pr-d/codeph ph codeph">EventSender</code> 向异构流表发送事件；当 CEP 引擎通过订阅接收并处理完数据后会向另一个异构流表输出消息， API 端再使用 <code class="+ topic/ph pr-d/codeph ph codeph">EventClient</code> 从该表订阅输出的事件。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Server 端创建基本要素</strong></p><p class="- topic/p p">下述脚本将在 DolphinDB 服务端创建两个异构流表 <em class="+ topic/ph hi-d/i ph i">input</em> 和 <em class="+ topic/ph hi-d/i ph i">output</em>，两个 streamEventSerializer（<a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/stream/serialize_and_deserialize.html?hl=streameventserializer" target="_blank" rel="external noopener">序列化接口</a>），一个 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/stream/cep_engine.html" target="_blank" rel="external noopener">CEP 引擎</a>，以及一个 MarketData <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/stream/cep_intro.html" target="_blank" rel="external noopener">事件</a>。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>login("admin","123456");

class MarketData{
  market :: STRING
  code :: STRING
  price :: DOUBLE
  qty :: INT
  eventTime :: TIMESTAMP
  def MarketData(m,c,p,q){
    market = m
    code = c
    price = p
    qty = q
    eventTime = now()   
  }
}   

class MainMonitor{
  
  def MainMonitor(){
  }
  def updateMarketData(event)

  def onload(){
    addEventListener(updateMarketData,'MarketData',,'all')
      }

  def updateMarketData(event){
    emitEvent(event)
  }
}

dummy = table(array(TIMESTAMP, 0) as eventTime, array(STRING, 0) as eventType, array(BLOB, 0) as blobs)
share streamTable(array(TIMESTAMP, 0) as eventTime, array(STRING, 0) as eventType, array(BLOB, 0) as blobs) as intput
share streamTable(array(TIMESTAMP, 0) as eventTime, array(STRING, 0) as eventType, array(BLOB, 0) as blobs) as output
schema = table(1:0, `eventType`eventKeys`eventValuesTypeString`eventValueTypeID`eventValuesFormID, [STRING, STRING, STRING, INT[], INT[]])
insert into schema values("MarketData", "market,code,price,qty,eventTime", "STRING,STRING,DOUBLE,INT,TIMESTAMP", [18 18 16 4 12], [0 0 0 0 0])
inputSerializer = streamEventSerializer(name=`serInput, eventSchemes=schema, outputTable=intput, eventTimeKey = "eventTime")
outputSerializer = streamEventSerializer(name=`serOutput, eventSchemes=schema, outputTable=output, eventTimeKey = "eventTime")

engine = createCEPEngine('cep1', &lt;MainMonitor()&gt;, dummy, [MarketData], 1, 'eventTime', 10000, outputSerializer)
subscribeTable(,`intput, `subopt, 0, getStreamEngine('cep1'),true)

marketData1 = MarketData('sz', 's001', 9.8, 100)
marketData2 = MarketData('sz', 's002', 6.9, 100)
marketData3 = MarketData('sz', 's003', 4.8, 100)
marketData4 = MarketData('sz', 's004', 9.8, 100)
marketData5 = MarketData('sz', 's005', 9.8, 100)
appendEvent(inputSerializer, [marketData1,marketData2,marketData3,marketData4,marketData5])</code></pre><p class="- topic/p p">API 端使用 <code class="+ topic/ph pr-d/codeph ph codeph">EventSender</code> 向 <em class="+ topic/ph hi-d/i ph i"><strong class="+ topic/ph hi-d/b ph b">input</strong></em> 表写入数据。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>// 定义 schema
EventSchema schema = new EventSchema();
schema.setEventType("MarketData");
schema.setFieldNames(Arrays.asList("market", "code", "price", "qty", "eventTime"));
schema.setFieldTypes(Arrays.asList(DT_STRING, DT_STRING, DT_DOUBLE, DT_INT, DT_TIMESTAMP));
schema.setFieldForms(Arrays.asList(DF_SCALAR, DF_SCALAR, DF_SCALAR, DF_SCALAR, DF_SCALAR));
List&lt;EventSchema&gt; eventSchemas = Collections.singletonList(scheme);
List&lt;String&gt; eventTimeKeys = Collections.singletonList("eventTime");
List&lt;String&gt; commonKeys = new ArrayList&lt;&gt;();

// 创建 EventSender
DBConnection conn = new DBConnection();
conn.connect(HOST, PORT, "admin", "123456");
EventSender sender = new EventSender(conn, "input", eventSchemas, eventTimeKeys, commonKeys);

// 准备数据：
List&lt;Entity&gt; attributes = new ArrayList&lt;&gt;();
attributes.add(new BasicString("sz"));
attributes.add(new BasicString("s001"));
attributes.add(new BasicDouble(9.8));
attributes.add(new BasicInt(100));
attributes.add(new BasicTimestamp(LocalDateTime.of(2024,3,13,15,11,10,630)));

sender.sendEvent("MarketData", attributes);</code></pre><p class="- topic/p p">CEP 引擎会去订阅 <em class="+ topic/ph hi-d/i ph i">input</em> 流表，在收到消息后，将消息输出到 <em class="+ topic/ph hi-d/i ph i">output</em> 流表。</p><p class="- topic/p p">API 端使用 <code class="+ topic/ph pr-d/codeph ph codeph">EventClient</code> 订阅 output 表。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>EventSchema scheme = new EventSchema();
scheme.setEventType("MarketData");
scheme.setFieldNames(Arrays.asList("market", "code", "price", "qty", "eventTime"));
scheme.setFieldTypes(Arrays.asList(DT_STRING, DT_STRING, DT_DOUBLE, DT_INT, DT_TIMESTAMP));
scheme.setFieldForms(Arrays.asList(DF_SCALAR, DF_SCALAR, DF_SCALAR, DF_SCALAR, DF_SCALAR));
List&lt;EventSchema&gt; eventSchemas = Collections.singletonList(scheme);
List&lt;String&gt; eventTimeKeys = Collections.singletonList("eventTime");
List&lt;String&gt; commonKeys = new ArrayList&lt;&gt;();

// 自定义的回调函数
EventMessageHandler handler = new EventMessageHandler() {
    @Override
    public void doEvent(String eventType, List&lt;Entity&gt; attribute) {
        // 自定义处理数据
        System.out.println("eventType: " + eventType);
        for (Entity entity : attribute) {
            System.out.println(entity.getString());
        }
        System.out.println("\n");
    }
};

// 创建事件订阅类
EventClient client = new EventClient(eventSchemas, eventTimeKeys, commonKeys);
// 订阅
client.subscribe(HOST, PORT, "output", "ss1", handler, 0, true, "admin", "123456");
Thread.sleep(10000);
// 取消订阅
client.unsubscribe(HOST, PORT, "output", "ss1");</code></pre></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#eventschema-%E6%9E%84%E9%80%A0%E4%BA%8B%E4%BB%B6" data-tocid="eventschema-构造事件">EventSchema 构造事件</a></li><li class="topic-item"><a href="#eventsender-%E5%8F%91%E9%80%81%E4%BA%8B%E4%BB%B6" data-tocid="eventsender-发送事件">EventSender 发送事件</a><ul><li class="topic-item"><a href="#sendevent-%E5%8F%91%E9%80%81" data-tocid="sendevent-发送"><strong class="+ topic/ph hi-d/b ph b">sendEvent 发送</strong></a></li></ul></li><li class="topic-item"><a href="#eventclient-%E8%AE%A2%E9%98%85%E4%BA%8B%E4%BB%B6" data-tocid="eventclient-订阅事件">EventClient 订阅事件</a><ul><li class="topic-item"><a href="#subscribe-%E8%AE%A2%E9%98%85" data-tocid="subscribe-订阅"><strong class="+ topic/ph hi-d/b ph b">subscribe 订阅</strong></a></li><li class="topic-item"><a href="#unsubscribe-%E5%8F%96%E6%B6%88%E8%AE%A2%E9%98%85" data-tocid="unsubscribe-取消订阅"><strong class="+ topic/ph hi-d/b ph b">unsubscribe 取消订阅</strong></a></li></ul></li><li class="topic-item"><a href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B" data-tocid="使用示例">使用示例</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2024 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>