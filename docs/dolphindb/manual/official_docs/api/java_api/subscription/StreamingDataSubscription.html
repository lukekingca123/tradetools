<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../../../favicon.ico"/><link rel="icon" href="../../../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Java API 支持流订阅，每当流表数据有更新时，Java 客户端可以通过流订阅方式获取更新的数据。Java API 有三种获取流数据的方式：ThreadedClient、ThreadPooledClient 以及 PollingClient。 构造说明： 2.00.9 及之后的版本支持发布端通过订阅端的请求连接推送数据。因此，订阅端无需指定端口（默认值为0）；如果指定，该参数无效，会被 API ..."/><meta name="DC.rights.owner" content="(C) 版权 2024"/><meta name="copyright" content="(C) 版权 2024"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../../../api/java_api/subscription.html"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="流订阅"/><title>流订阅</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../../../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20240704100525325/api/java_api/subscription?&gt;&lt;?workdir-uri file:/tmp/temp20240704100525325/api/java_api/subscription/?&gt;&lt;?path2project ../../../?&gt;&lt;?path2project-uri ../../../?&gt;&lt;?path2rootmap-uri ../../../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;流订阅&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;流订阅&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;Java API 支持流订阅，每当流表数据有更新时，Java 客户端可以通过流订阅方式获取更新的数据。Java API 有三种获取流数据的方式：ThreadedClient、ThreadPooledClient 以及 PollingClient。&lt;/p&gt;&lt;/body&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:99;279:40&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_connapi.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../../../api/java_api/subscription.dita&#34; mapclass=&#34;- map/topicref &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:98;277:61&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_connapi.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot gentext?&gt;订阅&lt;/linktext&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;三种流订阅工具的构造方式&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;三种流订阅工具的构造方式&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;构造说明：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;2.00.9 及之后的版本支持发布端通过订阅端的请求连接推送数据。因此，订阅端无需指定端口（默认值为0）；如果指定，该参数无效，会被 API 忽略。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;1.30 版本、2.00.9 之前的版本在订阅端提交订阅请求后，发布端需要重新发起一个 TCP 连接用于传输数据。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;threadedclient&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;ThreadedClient&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;14:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;每个订阅会新建一个数据处理线程，需要用户设置回调函数。每当有新的数据，对应的订阅线程就会用收到的数据来执行回调函数。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;16:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;构造方法：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:1;18:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;public ThreadedClient() public ThreadedClient(String subscribeHost, int subscribePort)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;23:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;参数说明：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;25:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:1;25:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribeHost&lt;/b&gt; String 类型，表示订阅的主机 IP，可选参数，默认为 localhost。若 Java 客户端机器有多个IP，这里可以指定使用某个 IP。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:2;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribePort&lt;/b&gt; int 类型，表示订阅的端口，可选参数，默认为 8849。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;threadpooledclient&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;29:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;29:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;ThreadPooledClient&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;29:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;多个订阅共用一个线程池。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;构造方法：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:2;35:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;public ThreadPooledClient() public ThreadPooledClient(String subscribeHost, int subscribePort, int threadCount)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;40:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;参数说明：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;42:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:3;42:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribeHost&lt;/b&gt; String 类型，表示订阅的主机 IP，可选参数，默认为空。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;44:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:4;44:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribePort&lt;/b&gt; int 类型，表示订阅的端口，可选参数，默认为 8849。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;46:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:5;46:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;threadCount&lt;/b&gt; int 类型，表示订阅线程数量，可选参数；如果不填，默认为当前计算机可用的线程资源数（Runtime.getRuntime().availableProcessors()）。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;pollingclient&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;48:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;48:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;PollingClient&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;48:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;50:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;订阅时返回一个队列，然后 poll 这个队列获取数据即可。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;52:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;构造方法：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:3;54:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;public PollingClient() public PollingClient(String subscribeHost, int subscribePort)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;59:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;参数说明：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;61:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribeHost String 类型，表示订阅的主机 IP，可选参数，默认为空。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;63:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribePort int 类型，表示订阅的端口。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;三种流订阅工具的订阅方式&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;三种流订阅工具的订阅方式&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;67:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;以上介绍了 Java API 提供的三种流订阅的构造方式，接下来介绍它们的订阅方式。它们都是通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;67:50&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribe&lt;/codeph&gt; 方法来进行订阅，且具有相同的订阅参数。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:4;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribe(String host, int port, String tableName, String actionName, MessageHandler handler, long offset, boolean reconnect, IVector filter, int batchSize, float throttle, StreamDeserializer deserializer, String user, String password, List&amp;lt;String&amp;gt; backupSites, int resubTimeout, boolean subOnce)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:20;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;**参数介绍 **&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:21;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:6;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;host&lt;/b&gt; String 类型，表示发布端节点的 IP 地址。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:22;77:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:7;77:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;port&lt;/b&gt; int 类型，表示发布端节点的端口号。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:23;79:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:8;79:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;tableName&lt;/b&gt; String 类型，表示发布表的名称。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:24;81:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:9;81:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;actionName&lt;/b&gt; String 类型，表示订阅任务的名称，选填参数，默认为 ”javaStreamingApi” 。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:25;83:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:10;83:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;handler&lt;/b&gt; 表示用户自定义的回调函数，用于处理每次流入的数据。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:26;85:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:11;85:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;offset&lt;/b&gt; 表示订阅任务开始后的第一条消息所在的位置，选填参数，默认为-1。一条消息对应流数据表中的一行。如果没有指定 offset，或它为负数，或超过了流数据表的记录行数，订阅将会从流数据表的当前行开始。offset 与流数据表创建时的第一行对应。如果某些行因为内存限制被删除，在决定订阅开始的位置时，这些行仍然考虑在内。具体可参考文档 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/funcs/s/subscribeTable.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:1;85:176&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;?ditaot usertext?&gt;DolphinDB-subscribeTable&lt;/xref&gt; 。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:27;87:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:12;87:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;reconnect&lt;/b&gt; boolean 类型，表示订阅中断后，是否会自动重订阅，选填参数，默认为 false 。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:28;89:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:13;89:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;filter&lt;/b&gt; 向量，表示过滤条件，参数函数可以参见 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/funcs/s/subscribeTable.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:2;89:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;?ditaot usertext?&gt;DolphinDB-subscribeTable&lt;/xref&gt; 的 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:1;89:118&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;filter&lt;/i&gt; 描述；选填参数，默认为 null 。流数据表过滤列在 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:2;89:154&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;filter&lt;/i&gt; 中的数据才会发布到订阅端，不在 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:3;89:179&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;filter&lt;/i&gt; 中的数据不会发布。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:29;91:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:14;91:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;batchSize&lt;/b&gt; int 类型，表示批处理的消息的数量。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;93:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;93:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;如果它是正数，直到消息的数量达到 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:4;93:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;batchSize&lt;/i&gt; 时，handler 才会处理进来的消息。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;94:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;如果它没有指定或者是非正数，消息到达之后，handler 就会马上处理消息。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:30;96:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;注意 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:5;96:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;batchSize&lt;/i&gt;，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:6;96:16&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;throttle&lt;/i&gt; 参数要求同时填写，两者都为可选参数，但没有默认值。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:31;98:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:15;98:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;throttle&lt;/b&gt; float 类型，表示 handler 处理到达的消息之前等待的时间。注意 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:7;98:52&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;batchSize&lt;/i&gt;，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:8;98:64&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;throttle&lt;/i&gt; 参数要求同时填写，两者都为可选参数，但没有默认值。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:32;100:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:16;100:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;deserializer&lt;/b&gt; 表示订阅的异构流表对应的反序列化器，可选参数，默认为 null。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:33;102:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:17;102:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;user&lt;/b&gt; String 类型，表示 Java API 所连接服务器的登录用户名，默认为 “” 即空字符串。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:34;104:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:18;104:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;password&lt;/b&gt; String 类型，表示 Java API 所连接服务器的登录密码，默认为“”即空字符串。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:35;106:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:19;106:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;backupSites&lt;/b&gt; String 类型列表，可选参数，表示备用的发布端节点列表，由节点 IP 和端口号组成，例如 [“192.168.0.1:8848“, “192.168.0.2:8849“]。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:3;108:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:5;108:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;指定 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:9;108:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;backupSites&lt;/i&gt;，表示启动主备节点切换。如果发生节点切换（例如连接断开），会在可用节点列表中不断轮询订阅，直至订阅成功。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:6;109:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;若配置该参数，用户须保证主节点（由 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:10;109:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;host&lt;/i&gt; 和 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:11;109:30&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;port&lt;/i&gt; 参数指定）和备用节点上存在相同结构、相同数据的同名流数据表。否则，可能出现订阅的数据不符合预期。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:7;110:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;若订阅的是高可用流表，重连时将从 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:12;110:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;backupSites&lt;/i&gt; 指定的节点列表中选择节点。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:8;111:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;取消订阅须使用主节点 IP 和端口号进行取消。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:36;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:20;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;resubTimeout&lt;/b&gt; int 类型，可选参数，表示重订阅距离断线最小时间间隔，单位为毫秒，默认值为 100。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:37;115:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:21;115:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subOnce&lt;/b&gt; boolean 类型，可选参数，表示是否在节点切换时尝试之前成功连接过的节点。默认值为 false，表示不尝试。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;示例代码&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;117:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;117:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;示例代码&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;117:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:38;119:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;下面分别介绍以上三种方式订阅流数据示例。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:4;121:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:9;121:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:22;121:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;使用 MessageHandler 回调的方式获取新数据&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:39;123:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;首先，用户需要自定义数据处理器 handler。handler 需要实现 com.xxdb.streaming.client.MessageHandler 接口。以下为自定义 handler 示例：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:5;125:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;public static MessageHandler MessageHandler_handler = new MessageHandler() { @Override public void doEvent(IMessage msg) { try { String script = String.format(&#34;insert into Receive values(%d,%s,%f)&#34;, Integer.parseInt(msg.getEntity(0).getString()), msg.getEntity(1).getString(), Double.valueOf(msg.getEntity(2).toString())); conn.run(script); // System.out.println(msg.getEntity(0).getString()); } catch (IOException e) { e.printStackTrace(); } } };&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:40;140:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;在启动订阅时，把 handler 实例作为参数传入订阅函数。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:41;142:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;包括单线程回调或多线程回调两种方式：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:1;144:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:10;144:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:42;144:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;单线程回调 &lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:23;144:10&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;ThreadedClient&lt;/b&gt;&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:6;146:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;@Test public void testThreadedClient() throws SocketException { // 1.30 版本、2.00.9 之前的版本，开启订阅，指定端口8000 ThreadedClient client = new ThreadedClient(8000); // 2.00.9 及之后的版本，开启订阅，无需指定端口 ThreadedClient client = new ThreadedClient(); client.subscribe(&#34;192.168.0.21&#34;, 8848, &#34;Trades&#34;, handler, -1); }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:43;157:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;当流数据表有新增数据时，系统会通知 Java API 调用 MyHandler 方法，将新数据通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;157:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;msg&lt;/codeph&gt; 参数传入。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:11;159:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:44;159:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;多线程回调 &lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:24;159:10&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;ThreadPooledClient&lt;/b&gt;&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:7;161:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;@Test public void testThreadPooledClient() throws SocketException { // 1.30 版本、2.00.9 之前的版本，开启订阅，指定端口8000 ThreadPooledClient client = new ThreadPooledClient(8000); // 2.00.9 及之后的版本，开启订阅，无需指定端口 ThreadPooledClient client = new ThreadPooledClient(); client.subscribe(&#34;192.168.0.21&#34;, 9002, &#34;Trades&#34;, handler, -1); }&lt;/codeblock&gt;&lt;/li&gt;&lt;/ol&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:5;172:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:12;172:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:45;172:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:25;172:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;通过客户机上的应用程序定期去流数据表查询是否有新增数据&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:46;174:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;该种情况下，推荐使用 &lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:26;174:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;PollingClient&lt;/b&gt;，具体使用方式见如下代码。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:8;176:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;@Test public void testPollingClient() { // 1.30 版本、2.00.9 之前的版本，开启订阅，指定端口8000 PollingClient client = new PollingClient(subscribePort); // 2.00.9 及之后的版本，开启订阅，无需指定端口 PollingClient client = new PollingClient(); tableName, TopicPoller poller1 = client.subscribe(&#34;192.168.0.21&#34;, 9002, &#34;Trades&#34;, -1); while (true) { ArrayList&amp;lt;IMessage&amp;gt; msgs = poller1.poll(1000); if (msgs.size() &amp;gt; 0) { // 取数据中第一行第三个字段 BasicInt value = (BasicInt) msgs.get(0).getEntity(2); } } }&lt;/codeblock&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:47;195:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;​ poller1 探测到流数据表有新增数据后，会拉取到新数据。无新数据发布时，Java 程序会阻塞在 poller1.poll 方法等待。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;重连-reconnect&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;197:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;197:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;重连 reconnect&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;197:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:48;199:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;若重连参数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:13;199:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;reconnect&lt;/i&gt; 设置为 true、订阅意外中断后，系统是否以及如何自动重新订阅，取决于订阅中断由以下哪种原因导致：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:6;201:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:13;201:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;如果发布端与订阅端处于正常状态，但是网络中断，那么订阅端会在网络正常时自动从中断位置重新订阅。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:14;202:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;如果发布端崩溃，订阅端会在发布端重启后不断尝试重新订阅。&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:7;203:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:15;203:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;如果发布端对流数据表启动了持久化，发布端重启后会首先读取硬盘上的数据，直到发布端读取到订阅中断位置的数据，订阅端才能成功重新订阅。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:16;204:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;如果发布端没有对流数据表启用持久化，那么订阅端将自动重新订阅失败。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:17;205:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;如果订阅端崩溃，订阅端重启后不会自动重新订阅，需要重新执行 subscribe 函数。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:49;207:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;以下为设置 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:14;207:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;reconnect&lt;/i&gt; 为 true 的例子：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:9;209:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;@Test public void testPollingClient() { PollingClient client = new PollingClient(9002); TopicPoller poller1 = client.subscribe(&#34;192.168.0.21&#34;, 9002, &#34;Trades&#34;, -1, true); }&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;启用-filter&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:9;217:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:9;217:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;启用 filter&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:9;217:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:50;219:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;filter 为过滤器，可以对发布到订阅端的数据进行过滤，参数为一个向量。该参数需要发布端配合&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;219:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;setStreamTableFilterColumn&lt;/codeph&gt;函数一起使用。使用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;219:85&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;setStreamTableFilterColumn&lt;/codeph&gt;指定流数据表的过滤列，如果列在 filter 中，流数据表才将该列会发布到订阅端，不在 filter 中的数据不会发布。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:51;221:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;以下例子将一个包含元素1和2的整数类型向量作为&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;221:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribe&lt;/codeph&gt;的filter参数值：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:10;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;@Test public void testEnableFilter() throws IOException { BasicIntVector filter = new BasicIntVector(2); filter.setInt(0, 1); filter.setInt(1, 2); PollingClient client = new PollingClient(9002); TopicPoller poller1 = client.subscribe(&#34;192.168.0.21&#34;, 9002,&#34;Trades1&#34;,&#34;subTread1&#34;,-1,filter); ArrayList&amp;lt;IMessage&amp;gt; msg1 = poller1.poll(500, 10000); }&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;订阅异构流表&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:10;235:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:10;235:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;订阅异构流表&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:10;235:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:52;237:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;DolphinDB server 自 1.30.17 及 2.00.5 版本开始，支持通过 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/funcs/r/replay.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:3;237:47&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;?ditaot usertext?&gt;replay&lt;/xref&gt; 函数将多个结构不同的流数据表回放（序列化）到一个流表里，这个流表被称为异构流表。Java API 自 1.30.19 版本开始，新增 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;237:173&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;StreamDeserializer&lt;/codeph&gt; 类，用于构造异构流表反序列化器，以实现对异构流表的订阅和反序列化操作。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:53;239:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;Java API 通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;239:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;StreamDeserializer&lt;/codeph&gt; 类来构造异构流表反序列化器，可参考：&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/funcs/s/streamFilter.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:4;239:52&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;?ditaot usertext?&gt;DolphinDB-streamFilter&lt;/xref&gt; ，语法如下：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:2;241:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:18;241:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;通过指定表的 schema 进行构造，包含以下两种方式，指定表的 schema 信息或指定表的各列类型：&lt;/li&gt;&lt;/ol&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:54;243:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;1）指定表的 schema 信息：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:11;245:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;StreamDeserializer(Map&amp;lt;String, BasicDictionary&amp;gt; filters)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:55;249:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;​ 其中，key 为 condition，value 为表的 schema。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:56;251:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;​ 2）指定表的各列类型：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:12;253:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;``` StreamDeserializer(HashMap&amp;lt;String, List&amp;lt;Entity.DATA_TYPE&amp;gt;&amp;gt; filters) ```&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:57;257:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;​ 其中，key 为 condition，value 为各列的类型。&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:3;259:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:19;259:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;通过指定表进行构造：&lt;/li&gt;&lt;/ol&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:13;261:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;StreamDeserializer(Map&amp;lt;String, Pair&amp;lt;String, String&amp;gt;&amp;gt; tableNames, DBConnection conn)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:58;265:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;其中，key 为表名，value 为 DBConnection。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:59;267:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;订阅示例：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:14;269:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;public class TestStreamDeserializer { // 假设异构流表回放时inputTables如下： // d = dict(['msg1', 'msg2'], [table1, table2]); // replay(inputTables = d, outputTables = `outTables, dateColumn = `timestampv, timeColumn = `timestampv)&#34;; // 异构流表解析器的创建方法如下： // 指定schema的方式 BasicDictionary table1_schema = (BasicDictionary)conn.run(&#34;table1.schema()&#34;); BasicDictionary table2_schema = (BasicDictionary)conn.run(&#34;table2.schema()&#34;); Map&amp;lt;String,BasicDictionary &amp;gt; tables = new HashMap&amp;lt;&amp;gt;(); tables.put(&#34;msg1&#34;, table1_schema); tables.put(&#34;msg2&#34;, table2_schema); StreamDeserializer streamFilter = new StreamDeserializer(tables); // 指定表的各列类型 Entity.DATA_TYPE[] array1 = {DT_DATETIME,DT_TIMESTAMP,DT_SYMBOL,DT_DOUBLE,DT_DOUBLE}; Entity.DATA_TYPE[] array2 = {DT_DATETIME,DT_TIMESTAMP,DT_SYMBOL,DT_DOUBLE}; List&amp;lt;Entity.DATA_TYPE&amp;gt; filter1 = new ArrayList&amp;lt;&amp;gt;(Arrays.asList(array1)); List&amp;lt;Entity.DATA_TYPE&amp;gt; filter2 = new ArrayList&amp;lt;&amp;gt;(Arrays.asList(array2)); HashMap&amp;lt;String, List&amp;lt;Entity.DATA_TYPE&amp;gt;&amp;gt; filter = new HashMap&amp;lt;&amp;gt;(); filter.put(&#34;msg1&#34;,filter1); filter.put(&#34;msg2&#34;,filter2); StreamDeserializer streamFilter = new StreamDeserializer(filter); // 指定表的方式 Map&amp;lt;String, Pair&amp;lt;String, String&amp;gt;&amp;gt; tables = new HashMap&amp;lt;&amp;gt;(); tables.put(&#34;msg1&#34;, new Pair&amp;lt;&amp;gt;(&#34;&#34;, &#34;table1&#34;)); tables.put(&#34;msg2&#34;, new Pair&amp;lt;&amp;gt;(&#34;&#34;, &#34;table2&#34;)); // conn是可选参数，如果不传入，在订阅的时候会自动使用订阅的conn进行构造 StreamDeserializer streamFilter = new StreamDeserializer(tables, conn); }&lt;/codeblock&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:15;303:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;下面分别介绍如何通过 `ThreadedClient`、`ThreadPooledClient` 和 `PollingClient` 三种方式订阅异构流表：&lt;/codeblock&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:4;305:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:20;305:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:60;305:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;305:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;ThreadedClient &lt;/codeph&gt;订阅异构流表：通过两种方式完成订阅时对异构流表的解析操作。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:8;307:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:21;307:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:61;307:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;通过指定 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;307:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribe&lt;/codeph&gt; 函数的 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:15;307:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;deserialize&lt;/i&gt; 参数，实现在订阅时直接解析异构流表：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:16;309:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;ThreadedClient client = new ThreadedClient(8676); client.subscribe(&#34;192.168.0.21&#34;, 9002,&#34;Trades1&#34;,&#34;subTread1&#34;, handler, -1, true, filter, streamFilter);&lt;/codeblock&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:22;314:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:62;314:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;异构流表（streamFilter）也可以写入用户自定义的 Handler 中，在回调时被解析：&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ol&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:17;316:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;public class CustomHandler implements MessageHandler { private StreamDeserializer deserializer_; private List&amp;lt;BasicMessage&amp;gt; msg1 = new ArrayList&amp;lt;&amp;gt;(); private List&amp;lt;BasicMessage&amp;gt; msg2 = new ArrayList&amp;lt;&amp;gt;(); public CustomHandler(StreamDeserializer deserializer) { deserializer_ = deserializer; } public void batchHandler(List&amp;lt;IMessage&amp;gt; msgs) { } public void doEvent(IMessage msg) { try { BasicMessage message = deserializer_.parse(msg); if (message.getSym().equals(&#34;msg1&#34;)) { msg1.add(message); } else if (message.getSym().equals(&#34;msg2&#34;)) { msg2.add(message); } } catch (Exception e) { e.printStackTrace(); } } public List&amp;lt;BasicMessage&amp;gt; getMsg1() { return msg1; } public List&amp;lt;BasicMessage&amp;gt; getMsg2() { return msg2; } } // 创建流表 conn.run(&#34;st11 = streamTable(100:0, `timestampv`id`blob`price1,[TIMESTAMP,INT,BLOB,DOUBLE])\n&#34; + &#34;enableTableShareAndPersistence(table=st11, tableName=`outTables, asynWrite=true, compress=true, cacheSize=200000, retentionMinutes=180, preCache = 0)\t\n&#34;); Map&amp;lt;String, Pair&amp;lt;String, String&amp;gt;&amp;gt; tables = new HashMap&amp;lt;&amp;gt;(); StreamDeserializer streamFilter = new StreamDeserializer(tables, conn); CustomHandler handler = new CustomHandler(streamFilter); ThreadedClient client = new ThreadedClient(8848); client.subscribe(&#34;192.168.0.21&#34;, 9002, &#34;outTables&#34;, &#34;mutiSchema&#34;, handler, 0, true); conn.run(&#34;t = table(timestamp(1 2) as a,1 2 as b,blob(`a`b) as c,1.1 2.1 as d)\n&#34; + &#34;outTables.append!(t)&#34;); List&amp;lt;BasicMessage&amp;gt; msg1 = handler.getMsg1(); List&amp;lt;BasicMessage&amp;gt; msg2 = handler.getMsg2(); client.unsubscribe(&#34;192.168.0.21&#34;, 9002, &#34;outTables&#34;, &#34;mutiSchema&#34;);&lt;/codeblock&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:5;365:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:23;365:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:63;365:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;365:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;ThreadPooledClient&lt;/codeph&gt; 订阅异构流表的方法和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;365:39&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;ThreadedClient&lt;/codeph&gt; 一致。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:9;367:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:24;367:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:64;367:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;指定 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;367:10&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribe&lt;/codeph&gt; 函数的 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:16;367:26&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;deserialize&lt;/i&gt; 参数：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:18;369:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;CustomHandler handler = new CustomHandler(streamFilter); ThreadPooledClient client1 = new ThreadPooledClient(9050, 10); // client.subscribe(hostName, port, tableName, actionName, handler, 0, true); // client.subscribe(&#34;192.168.0.21&#34;, 9002, &#34;Trades&#34;, handler); // client.subscribe(&#34;192.168.0.21&#34;, 9002, &#34;outTables&#34;, &#34;mutiSchema&#34;, handler, 0, true); client.subscribe(&#34;192.168.0.21&#34;, 9002,&#34;Trades1&#34;,&#34;subTread1&#34;, handler, -1, true, filter, streamFilter);&lt;/codeblock&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:25;378:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:65;378:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;异构流表（streamFilter）也可以写入客户自定义的 Handler 中，在回调时被解析：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:19;380:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;CustomHandler handler = new CustomHandler(streamFilter); ThreadPooledClient client = new ThreadPooledClient(9050, 10); client.subscribe(&#34;192.168.0.21&#34;, 9002, &#34;outTables&#34;, &#34;mutiSchema&#34;, handler, 0, true);&lt;/codeblock&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:66;386:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;由于 PollingClient 没有回调函数，只能通过为 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:13;386:35&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;subscribe&lt;/codeph&gt; 函数的 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:17;386:51&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;deserialize&lt;/i&gt; 参数传入 streamFilter 的方式进行解析：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:20;388:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt; ``` PollingClient client = new PollingClient(9050); TopicPoller poller1 = client.subscribe(&#34;192.168.0.21&#34;, 9002, &#34;Trades&#34;, &#34;subTread1&#34;, 0, true, null, streamFilter,&#34;&#34;,&#34;&#34;,true); ArrayList&amp;lt;IMessage&amp;gt; msg1; List&amp;lt;String&amp;gt; colNames = Arrays.asList(&#34;tag&#34;,&#34;ts&#34;,&#34;data&#34;); List&amp;lt;Vector&amp;gt; colData = Arrays.asList(new BasicIntVector(0),new BasicTimestampVector(0),new BasicDoubleVector(0)); BasicTable bt = new BasicTable(colNames,colData); conn.run(&#34;n=5000;t=table(1..n as tag,now()+1..n as ts,rand(100.0,n) as data);&#34; + &#34;Trades.append!(t)&#34;); msg1 = poller1.poll(1000, 10000); ```&lt;/codeblock&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;取消订阅&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:11;400:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:11;400:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;取消订阅&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:11;400:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:67;402:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;停止订阅数据使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:14;402:10&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;unsubscribe&lt;/codeph&gt; 方法。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:21;404:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;public void unsubscribe(String host, int port, String tableName, String actionName)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:68;408:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;示例代码：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:22;410:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/java_api/subscription/StreamingDataSubscription.md&#34;&gt;client.unsubscribe(&#34;192.168.0.21&#34;, 9002, &#34;outTables&#34;, &#34;mutiSchema&#34;);&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="api/java_api/subscription/StreamingDataSubscription.md"/><meta name="wh-out-relpath" content="api/java_api/subscription/StreamingDataSubscription.html"/>

    <link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../../../oxygen-webhelp/app/options/properties.js?buildId=20240704100525"></script>
    <script src="../../../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../../../oxygen-webhelp/app/search/index/keywords.js?buildId=20240704100525"></script>
    <script defer="defer" src="../../../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../../../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../../../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="流订阅" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://www.dolphindb.cn" class=" wh_logo d-none d-sm-block "><img src="../../../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../../../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../../../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>

            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../../../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="api_protocol"><div class="title"><a href="../../../api/connapi_intro.html"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li><div class="topicref" data-id="javaapi_landingpage"><div class="title"><a href="../../../api/java_api/newjava.html">Java API</a></div></div></li><li><div class="topicref" data-id="subscription"><div class="title"><a href="../../../api/java_api/subscription.html">订阅</a></div></div></li><li class="active"><div class="topicref" data-id="流订阅"><div class="title"><a href="../../../api/java_api/subscription/StreamingDataSubscription.html">流订阅</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="new_chap_about_sect_ddb_docs_intro-d9529e87" class="topicref" data-id="new_chap_about_sect_ddb_docs_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../about/ddb_docs_intro.html" id="new_chap_about_sect_ddb_docs_intro-d9529e87-link">文档使用说明</a><div class="wh-tooltip"><p class="shortdesc">如何获取 DolphinDB 帮助信息</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap1_getstarted-d9529e140" class="topicref" data-id="chap1_getstarted" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap1_getstarted-d9529e140-link" class="wh-expand-btn"></span><div class="title"><a href="../../../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9529e140-link"><span class="keyword label">快速上手</span></a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9529e335" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9529e335-link" class="wh-expand-btn"></span><div class="title"><a href="../../../deploy/deploy_intro.html" id="sectionddb_deployment-d9529e335-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9529e2313" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9529e2313-link" class="wh-expand-btn"></span><div class="title"><a href="../../../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9529e2313-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9529e3490" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9529e3490-link" class="wh-expand-btn"></span><div class="title"><a href="../../../stream/str_intro.html" id="chap7_tutorials_streaming-d9529e3490-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9529e7385" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9529e7385-link" class="wh-expand-btn"></span><div class="title"><a href="../../../db_distr_comp/db_oper/import_data.html" id="tocId-d9529e7385-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9529e7812" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9529e7812-link" class="wh-expand-btn"></span><div class="title"><a href="../../../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9529e7812-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9529e16490" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9529e16490-link" class="wh-expand-btn"></span><div class="title"><a href="../../../progr/progr_intro.html" id="about_language_resources-d9529e16490-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9529e26503" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9529e26503-link" class="wh-expand-btn"></span><div class="title"><a href="../../../funcs/funcs_intro.html" id="functions_references-d9529e26503-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="api_protocol-d9529e86456" class="topicref" data-id="api_protocol" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action api_protocol-d9529e86456-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/connapi_intro.html" id="api_protocol-d9529e86456-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="cpp_api-d9529e86509" class="topicref" data-id="cpp_api" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action cpp_api-d9529e86509-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/cpp/cpp_api.html" id="cpp_api-d9529e86509-link">C++ API</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap5_sectpythonapi-d9529e88349" class="topicref" data-id="chap5_sectpythonapi" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap5_sectpythonapi-d9529e88349-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/python/py.html" id="chap5_sectpythonapi-d9529e88349-link"><span class="keyword label">Python API</span></a></div></div></li><li role="treeitem"><div data-tocid="c-api-d9529e90273" class="topicref" data-id="c-api" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/csharp.html" id="c-api-d9529e90273-link">C# API</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="javaapi_landingpage-d9529e90319" class="topicref" data-id="javaapi_landingpage" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action javaapi_landingpage-d9529e90319-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/newjava.html" id="javaapi_landingpage-d9529e90319-link">Java API</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="安装-d9529e90365" class="topicref" data-id="安装" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/install.html" id="安装-d9529e90365-link">安装</a></div></div></li><li role="treeitem"><div data-tocid="快速开始-d9529e90411" class="topicref" data-id="快速开始" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/quickstart.html" id="快速开始-d9529e90411-link">快速开始</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_datatypes_forms-d9529e90457" class="topicref" data-id="java_api_datatypes_forms" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_datatypes_forms-d9529e90457-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_data_types_forms.html" id="java_api_datatypes_forms-d9529e90457-link">数据类型与形式</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_basic_ops-d9529e90641" class="topicref" data-id="java_api_basic_ops" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_basic_ops-d9529e90641-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_con_ops.html" id="java_api_basic_ops-d9529e90641-link">连接相关</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_landingpage-d9529e90917" class="topicref" data-id="java_api_landingpage" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_landingpage-d9529e90917-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_conpool.html" id="java_api_landingpage-d9529e90917-link">连接池</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="subscription-d9529e91055" class="topicref" data-id="subscription" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action subscription-d9529e91055-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/subscription.html" id="subscription-d9529e91055-link">订阅</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" class="active"><div data-tocid="流订阅-d9529e91101" class="topicref" data-id="流订阅" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/subscription/StreamingDataSubscription.html" id="流订阅-d9529e91101-link">流订阅</a></div></div></li><li role="treeitem"><div data-tocid="事件订阅-d9529e91147" class="topicref" data-id="事件订阅" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/subscription/cep.html" id="事件订阅-d9529e91147-link">事件订阅</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_write_data-d9529e91193" class="topicref" data-id="java_api_write_data" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_write_data-d9529e91193-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_write_data.html" id="java_api_write_data-d9529e91193-link">数据写入</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_troubleshooting-d9529e91469" class="topicref" data-id="java_api_troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_troubleshooting-d9529e91469-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_troubleshooting.html" id="java_api_troubleshooting-d9529e91469-link">FAQ</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="java_api_appendix-d9529e91653" class="topicref" data-id="java_api_appendix" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action java_api_appendix-d9529e91653-link" class="wh-expand-btn"></span><div class="title"><a href="../../../api/java_api/java_api_attachment.html" id="java_api_appendix-d9529e91653-link">附录</a></div></div></li></ul></li><li role="treeitem"><div data-tocid="jdbc-连接器-d9529e91745" class="topicref" data-id="jdbc-连接器" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/jdbc.html" id="jdbc-连接器-d9529e91745-link">JDBC 连接器</a></div></div></li><li role="treeitem"><div data-tocid="go-api-d9529e91791" class="topicref" data-id="go-api" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/go.html" id="go-api-d9529e91791-link">Go API</a></div></div></li><li role="treeitem"><div data-tocid="javascript-api-d9529e91837" class="topicref" data-id="javascript-api" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/js.html" id="javascript-api-d9529e91837-link">JavaScript API</a></div></div></li><li role="treeitem"><div data-tocid="json-api-d9529e91883" class="topicref" data-id="json-api" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/json.html" id="json-api-d9529e91883-link">JSON API</a></div></div></li><li role="treeitem"><div data-tocid="r-api-d9529e91929" class="topicref" data-id="r-api" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../../api/r.html" id="r-api-d9529e91929-link">R API</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap6_plugin-d9529e91976" class="topicref" data-id="chap6_plugin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap6_plugin-d9529e91976-link" class="wh-expand-btn"></span><div class="title"><a href="../../../plugins/plg_intro.html" id="chap6_plugin-d9529e91976-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9529e94749" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9529e94749-link" class="wh-expand-btn"></span><div class="title"><a href="../../../third_party.html" id="third_party-d9529e94749-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_tutorials-d9529e94980" class="topicref" data-id="about_tutorials" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_tutorials-d9529e94980-link" class="wh-expand-btn"></span><div class="title"><a href="../../../tutorials/about_tutorials.html" id="about_tutorials-d9529e94980-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9529e101769" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9529e101769-link" class="wh-expand-btn"></span><div class="title"><a href="../../../rn/server/3_00_1.html" id="tocId-d9529e101769-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">流订阅</h1><div class="- topic/body body"><p class="- topic/p p">Java API 支持流订阅，每当流表数据有更新时，Java 客户端可以通过流订阅方式获取更新的数据。Java API 有三种获取流数据的方式：ThreadedClient、ThreadPooledClient 以及 PollingClient。</p></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="三种流订阅工具的构造方式"><h2 class="- topic/title title topictitle2" id="ariaid-title2">三种流订阅工具的构造方式</h2><div class="- topic/body body"><p class="- topic/p p">构造说明：</p><ul class="- topic/ul ul"><li class="- topic/li li">2.00.9 及之后的版本支持发布端通过订阅端的请求连接推送数据。因此，订阅端无需指定端口（默认值为0）；如果指定，该参数无效，会被 API 忽略。</li><li class="- topic/li li">1.30 版本、2.00.9 之前的版本在订阅端提交订阅请求后，发布端需要重新发起一个 TCP 连接用于传输数据。</li></ul></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title3" id="threadedclient"><h3 class="- topic/title title topictitle3" id="ariaid-title3">ThreadedClient</h3><div class="- topic/body body"><p class="- topic/p p">每个订阅会新建一个数据处理线程，需要用户设置回调函数。每当有新的数据，对应的订阅线程就会用收到的数据来执行回调函数。</p><p class="- topic/p p">构造方法：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public ThreadedClient()
public ThreadedClient(String subscribeHost, int subscribePort)</code></pre><p class="- topic/p p">参数说明：</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">subscribeHost</strong> String 类型，表示订阅的主机 IP，可选参数，默认为 localhost。若 Java 客户端机器有多个IP，这里可以指定使用某个 IP。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">subscribePort</strong> int 类型，表示订阅的端口，可选参数，默认为 8849。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title4" id="threadpooledclient"><h3 class="- topic/title title topictitle3" id="ariaid-title4">ThreadPooledClient</h3><div class="- topic/body body"><p class="- topic/p p">多个订阅共用一个线程池。</p><p class="- topic/p p">构造方法：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public ThreadPooledClient()
public ThreadPooledClient(String subscribeHost, int subscribePort, int threadCount)</code></pre><p class="- topic/p p">参数说明：</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">subscribeHost</strong> String 类型，表示订阅的主机 IP，可选参数，默认为空。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">subscribePort</strong> int 类型，表示订阅的端口，可选参数，默认为 8849。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">threadCount</strong> int 类型，表示订阅线程数量，可选参数；如果不填，默认为当前计算机可用的线程资源数（Runtime.getRuntime().availableProcessors()）。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title5" id="pollingclient"><h3 class="- topic/title title topictitle3" id="ariaid-title5">PollingClient</h3><div class="- topic/body body"><p class="- topic/p p">订阅时返回一个队列，然后 poll 这个队列获取数据即可。</p><p class="- topic/p p">构造方法：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public PollingClient()
public PollingClient(String subscribeHost, int subscribePort)</code></pre><p class="- topic/p p">参数说明：</p><p class="- topic/p p">subscribeHost String 类型，表示订阅的主机 IP，可选参数，默认为空。</p><p class="- topic/p p">subscribePort int 类型，表示订阅的端口。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title6" id="三种流订阅工具的订阅方式"><h2 class="- topic/title title topictitle2" id="ariaid-title6">三种流订阅工具的订阅方式</h2><div class="- topic/body body"><p class="- topic/p p">以上介绍了 Java API 提供的三种流订阅的构造方式，接下来介绍它们的订阅方式。它们都是通过 <code class="+ topic/ph pr-d/codeph ph codeph">subscribe</code> 方法来进行订阅，且具有相同的订阅参数。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>subscribe(String host, int port, String tableName, String actionName, MessageHandler handler, long offset, boolean reconnect, IVector filter, int batchSize, float throttle, StreamDeserializer deserializer, String user, String password, List&lt;String&gt; backupSites, int resubTimeout, boolean subOnce)</code></pre><p class="- topic/p p">**参数介绍 **</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">host</strong> String 类型，表示发布端节点的 IP 地址。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">port</strong> int 类型，表示发布端节点的端口号。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">tableName</strong> String 类型，表示发布表的名称。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">actionName</strong> String 类型，表示订阅任务的名称，选填参数，默认为 ”javaStreamingApi” 。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">handler</strong> 表示用户自定义的回调函数，用于处理每次流入的数据。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">offset</strong> 表示订阅任务开始后的第一条消息所在的位置，选填参数，默认为-1。一条消息对应流数据表中的一行。如果没有指定 offset，或它为负数，或超过了流数据表的记录行数，订阅将会从流数据表的当前行开始。offset 与流数据表创建时的第一行对应。如果某些行因为内存限制被删除，在决定订阅开始的位置时，这些行仍然考虑在内。具体可参考文档 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/funcs/s/subscribeTable.html" target="_blank" rel="external noopener">DolphinDB-subscribeTable</a> 。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">reconnect</strong> boolean 类型，表示订阅中断后，是否会自动重订阅，选填参数，默认为 false 。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">filter</strong> 向量，表示过滤条件，参数函数可以参见 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/funcs/s/subscribeTable.html" target="_blank" rel="external noopener">DolphinDB-subscribeTable</a> 的 <em class="+ topic/ph hi-d/i ph i">filter</em> 描述；选填参数，默认为 null 。流数据表过滤列在 <em class="+ topic/ph hi-d/i ph i">filter</em> 中的数据才会发布到订阅端，不在 <em class="+ topic/ph hi-d/i ph i">filter</em> 中的数据不会发布。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">batchSize</strong> int 类型，表示批处理的消息的数量。</p><ul class="- topic/ul ul"><li class="- topic/li li">如果它是正数，直到消息的数量达到 <em class="+ topic/ph hi-d/i ph i">batchSize</em> 时，handler 才会处理进来的消息。</li><li class="- topic/li li">如果它没有指定或者是非正数，消息到达之后，handler 就会马上处理消息。</li></ul><p class="- topic/p p">注意 <em class="+ topic/ph hi-d/i ph i">batchSize</em>，<em class="+ topic/ph hi-d/i ph i">throttle</em> 参数要求同时填写，两者都为可选参数，但没有默认值。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">throttle</strong> float 类型，表示 handler 处理到达的消息之前等待的时间。注意 <em class="+ topic/ph hi-d/i ph i">batchSize</em>，<em class="+ topic/ph hi-d/i ph i">throttle</em> 参数要求同时填写，两者都为可选参数，但没有默认值。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">deserializer</strong> 表示订阅的异构流表对应的反序列化器，可选参数，默认为 null。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">user</strong> String 类型，表示 Java API 所连接服务器的登录用户名，默认为 “” 即空字符串。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">password</strong> String 类型，表示 Java API 所连接服务器的登录密码，默认为“”即空字符串。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">backupSites</strong> String 类型列表，可选参数，表示备用的发布端节点列表，由节点 IP 和端口号组成，例如 [“192.168.0.1:8848“, “192.168.0.2:8849“]。</p><ul class="- topic/ul ul"><li class="- topic/li li">指定 <em class="+ topic/ph hi-d/i ph i">backupSites</em>，表示启动主备节点切换。如果发生节点切换（例如连接断开），会在可用节点列表中不断轮询订阅，直至订阅成功。</li><li class="- topic/li li">若配置该参数，用户须保证主节点（由 <em class="+ topic/ph hi-d/i ph i">host</em> 和 <em class="+ topic/ph hi-d/i ph i">port</em> 参数指定）和备用节点上存在相同结构、相同数据的同名流数据表。否则，可能出现订阅的数据不符合预期。</li><li class="- topic/li li">若订阅的是高可用流表，重连时将从 <em class="+ topic/ph hi-d/i ph i">backupSites</em> 指定的节点列表中选择节点。</li><li class="- topic/li li">取消订阅须使用主节点 IP 和端口号进行取消。</li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">resubTimeout</strong> int 类型，可选参数，表示重订阅距离断线最小时间间隔，单位为毫秒，默认值为 100。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">subOnce</strong> boolean 类型，可选参数，表示是否在节点切换时尝试之前成功连接过的节点。默认值为 false，表示不尝试。</p></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title7" id="示例代码"><h3 class="- topic/title title topictitle3" id="ariaid-title7">示例代码</h3><div class="- topic/body body"><p class="- topic/p p">下面分别介绍以上三种方式订阅流数据示例。</p><ul class="- topic/ul ul"><li class="- topic/li li"><strong class="+ topic/ph hi-d/b ph b">使用 MessageHandler 回调的方式获取新数据</strong></li></ul><p class="- topic/p p">首先，用户需要自定义数据处理器 handler。handler 需要实现 com.xxdb.streaming.client.MessageHandler 接口。以下为自定义 handler 示例：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public static MessageHandler MessageHandler_handler = new MessageHandler() {
    @Override
    public void doEvent(IMessage msg) {
        try {
            String script = String.format("insert into Receive values(%d,%s,%f)", Integer.parseInt(msg.getEntity(0).getString()), msg.getEntity(1).getString(), Double.valueOf(msg.getEntity(2).toString()));
            conn.run(script);
            //  System.out.println(msg.getEntity(0).getString());
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
};</code></pre><p class="- topic/p p">在启动订阅时，把 handler 实例作为参数传入订阅函数。</p><p class="- topic/p p">包括单线程回调或多线程回调两种方式：</p><ol class="- topic/ol ol"><li class="- topic/li li"><p class="- topic/p p">单线程回调 <strong class="+ topic/ph hi-d/b ph b">ThreadedClient</strong></p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>@Test
public void testThreadedClient() throws SocketException {
    // 1.30 版本、2.00.9 之前的版本，开启订阅，指定端口8000
    ThreadedClient client = new ThreadedClient(8000);
    // 2.00.9 及之后的版本，开启订阅，无需指定端口
    ThreadedClient client = new ThreadedClient();
    client.subscribe("192.168.0.21", 8848, "Trades", handler, -1);
}</code></pre><p class="- topic/p p">当流数据表有新增数据时，系统会通知 Java API 调用 MyHandler 方法，将新数据通过 <code class="+ topic/ph pr-d/codeph ph codeph">msg</code> 参数传入。</p></li><li class="- topic/li li"><p class="- topic/p p">多线程回调 <strong class="+ topic/ph hi-d/b ph b">ThreadPooledClient</strong></p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>@Test
public void testThreadPooledClient() throws SocketException {
    // 1.30 版本、2.00.9 之前的版本，开启订阅，指定端口8000
    ThreadPooledClient client = new ThreadPooledClient(8000);
    // 2.00.9 及之后的版本，开启订阅，无需指定端口
    ThreadPooledClient client = new ThreadPooledClient();
    client.subscribe("192.168.0.21", 9002, "Trades", handler, -1);
}</code></pre></li></ol><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">通过客户机上的应用程序定期去流数据表查询是否有新增数据</strong></p><p class="- topic/p p">该种情况下，推荐使用 <strong class="+ topic/ph hi-d/b ph b">PollingClient</strong>，具体使用方式见如下代码。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>@Test
public void testPollingClient() {
    // 1.30 版本、2.00.9 之前的版本，开启订阅，指定端口8000
    PollingClient client = new PollingClient(subscribePort);
    // 2.00.9 及之后的版本，开启订阅，无需指定端口
    PollingClient client = new PollingClient();
    tableName, TopicPoller poller1 = client.subscribe("192.168.0.21", 9002, "Trades", -1);

    while (true) {
        ArrayList&lt;IMessage&gt; msgs = poller1.poll(1000);
        if (msgs.size() &gt; 0) {
            // 取数据中第一行第三个字段
            BasicInt value = (BasicInt) msgs.get(0).getEntity(2);
        }
    }
}</code></pre></li></ul><p class="- topic/p p">​	poller1 探测到流数据表有新增数据后，会拉取到新数据。无新数据发布时，Java 程序会阻塞在 poller1.poll 方法等待。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title8" id="重连-reconnect"><h2 class="- topic/title title topictitle2" id="ariaid-title8">重连 reconnect</h2><div class="- topic/body body"><p class="- topic/p p">若重连参数 <em class="+ topic/ph hi-d/i ph i">reconnect</em> 设置为 true、订阅意外中断后，系统是否以及如何自动重新订阅，取决于订阅中断由以下哪种原因导致：</p><ul class="- topic/ul ul"><li class="- topic/li li">如果发布端与订阅端处于正常状态，但是网络中断，那么订阅端会在网络正常时自动从中断位置重新订阅。</li><li class="- topic/li li">如果发布端崩溃，订阅端会在发布端重启后不断尝试重新订阅。<ul class="- topic/ul ul"><li class="- topic/li li">如果发布端对流数据表启动了持久化，发布端重启后会首先读取硬盘上的数据，直到发布端读取到订阅中断位置的数据，订阅端才能成功重新订阅。</li><li class="- topic/li li">如果发布端没有对流数据表启用持久化，那么订阅端将自动重新订阅失败。</li></ul></li><li class="- topic/li li">如果订阅端崩溃，订阅端重启后不会自动重新订阅，需要重新执行 subscribe 函数。</li></ul><p class="- topic/p p">以下为设置 <em class="+ topic/ph hi-d/i ph i">reconnect</em> 为 true 的例子：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>@Test
public void testPollingClient() {
    PollingClient client = new PollingClient(9002);
    TopicPoller poller1 = client.subscribe("192.168.0.21", 9002, "Trades", -1, true);
}</code></pre></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title9" id="启用-filter"><h2 class="- topic/title title topictitle2" id="ariaid-title9">启用 filter</h2><div class="- topic/body body"><p class="- topic/p p">filter 为过滤器，可以对发布到订阅端的数据进行过滤，参数为一个向量。该参数需要发布端配合<code class="+ topic/ph pr-d/codeph ph codeph">setStreamTableFilterColumn</code>函数一起使用。使用<code class="+ topic/ph pr-d/codeph ph codeph">setStreamTableFilterColumn</code>指定流数据表的过滤列，如果列在 filter 中，流数据表才将该列会发布到订阅端，不在 filter 中的数据不会发布。</p><p class="- topic/p p">以下例子将一个包含元素1和2的整数类型向量作为<code class="+ topic/ph pr-d/codeph ph codeph">subscribe</code>的filter参数值：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>@Test
public void testEnableFilter() throws IOException {
    BasicIntVector filter = new BasicIntVector(2);
    filter.setInt(0, 1);
    filter.setInt(1, 2);
    PollingClient client = new PollingClient(9002);
    TopicPoller poller1 = client.subscribe("192.168.0.21", 9002,"Trades1","subTread1",-1,filter);
    ArrayList&lt;IMessage&gt; msg1 = poller1.poll(500, 10000);
}</code></pre></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title10" id="订阅异构流表"><h2 class="- topic/title title topictitle2" id="ariaid-title10">订阅异构流表</h2><div class="- topic/body body"><p class="- topic/p p">DolphinDB server 自 1.30.17 及 2.00.5 版本开始，支持通过 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/funcs/r/replay.html" target="_blank" rel="external noopener">replay</a> 函数将多个结构不同的流数据表回放（序列化）到一个流表里，这个流表被称为异构流表。Java API 自 1.30.19 版本开始，新增 <code class="+ topic/ph pr-d/codeph ph codeph">StreamDeserializer</code> 类，用于构造异构流表反序列化器，以实现对异构流表的订阅和反序列化操作。</p><p class="- topic/p p">Java API 通过 <code class="+ topic/ph pr-d/codeph ph codeph">StreamDeserializer</code> 类来构造异构流表反序列化器，可参考：<a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/funcs/s/streamFilter.html" target="_blank" rel="external noopener">DolphinDB-streamFilter</a> ，语法如下：</p><ol class="- topic/ol ol"><li class="- topic/li li">通过指定表的 schema 进行构造，包含以下两种方式，指定表的 schema 信息或指定表的各列类型：</li></ol><p class="- topic/p p">1）指定表的 schema 信息：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>StreamDeserializer(Map&lt;String, BasicDictionary&gt; filters)</code></pre><p class="- topic/p p">​	其中，key 为 condition，value 为表的 schema。</p><p class="- topic/p p">​	2）指定表的各列类型：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>```
StreamDeserializer(HashMap&lt;String, List&lt;Entity.DATA_TYPE&gt;&gt; filters)
```</code></pre><p class="- topic/p p">​	其中，key 为 condition，value 为各列的类型。</p><ol class="- topic/ol ol"><li class="- topic/li li">通过指定表进行构造：</li></ol><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>StreamDeserializer(Map&lt;String, Pair&lt;String, String&gt;&gt; tableNames, DBConnection conn)</code></pre><p class="- topic/p p">其中，key 为表名，value 为 DBConnection。</p><p class="- topic/p p">订阅示例：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public class TestStreamDeserializer {
    // 假设异构流表回放时inputTables如下：
    // d = dict(['msg1', 'msg2'], [table1, table2]);
    // replay(inputTables = d, outputTables = `outTables, dateColumn = `timestampv, timeColumn = `timestampv)";

    // 异构流表解析器的创建方法如下：
    // 指定schema的方式
    BasicDictionary table1_schema = (BasicDictionary)conn.run("table1.schema()");
    BasicDictionary table2_schema = (BasicDictionary)conn.run("table2.schema()");
    Map&lt;String,BasicDictionary &gt; tables = new HashMap&lt;&gt;();
    tables.put("msg1", table1_schema);
    tables.put("msg2", table2_schema);
    StreamDeserializer streamFilter = new StreamDeserializer(tables);

    // 指定表的各列类型
    Entity.DATA_TYPE[] array1 = {DT_DATETIME,DT_TIMESTAMP,DT_SYMBOL,DT_DOUBLE,DT_DOUBLE};
    Entity.DATA_TYPE[] array2 = {DT_DATETIME,DT_TIMESTAMP,DT_SYMBOL,DT_DOUBLE};
    List&lt;Entity.DATA_TYPE&gt; filter1 = new ArrayList&lt;&gt;(Arrays.asList(array1));
    List&lt;Entity.DATA_TYPE&gt; filter2 = new ArrayList&lt;&gt;(Arrays.asList(array2));
    HashMap&lt;String, List&lt;Entity.DATA_TYPE&gt;&gt; filter = new HashMap&lt;&gt;();
    filter.put("msg1",filter1);
    filter.put("msg2",filter2);
    StreamDeserializer streamFilter = new StreamDeserializer(filter);

    // 指定表的方式
    Map&lt;String, Pair&lt;String, String&gt;&gt; tables = new HashMap&lt;&gt;();
    tables.put("msg1", new Pair&lt;&gt;("", "table1"));
    tables.put("msg2", new Pair&lt;&gt;("", "table2"));
    // conn是可选参数，如果不传入，在订阅的时候会自动使用订阅的conn进行构造
    StreamDeserializer streamFilter = new StreamDeserializer(tables, conn);
}</code></pre><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>下面分别介绍如何通过 `ThreadedClient`、`ThreadPooledClient` 和 `PollingClient` 三种方式订阅异构流表：</code></pre><ol class="- topic/ol ol"><li class="- topic/li li"><p class="- topic/p p">通过 <code class="+ topic/ph pr-d/codeph ph codeph">ThreadedClient </code>订阅异构流表：通过两种方式完成订阅时对异构流表的解析操作。</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">通过指定 <code class="+ topic/ph pr-d/codeph ph codeph">subscribe</code> 函数的 <em class="+ topic/ph hi-d/i ph i">deserialize</em> 参数，实现在订阅时直接解析异构流表：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ThreadedClient client = new ThreadedClient(8676);
client.subscribe("192.168.0.21", 9002,"Trades1","subTread1", handler, -1, true, filter, streamFilter);</code></pre></li><li class="- topic/li li"><p class="- topic/p p">异构流表（streamFilter）也可以写入用户自定义的 Handler 中，在回调时被解析：</p></li></ul></li></ol><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public class CustomHandler implements MessageHandler {
    private StreamDeserializer deserializer_;
    private List&lt;BasicMessage&gt; msg1 = new ArrayList&lt;&gt;();
    private List&lt;BasicMessage&gt; msg2 = new ArrayList&lt;&gt;();

    public CustomHandler(StreamDeserializer deserializer) {
        deserializer_ = deserializer;
    }
    public void batchHandler(List&lt;IMessage&gt; msgs) {
    }

    public void doEvent(IMessage msg) {
        try {
                BasicMessage message = deserializer_.parse(msg);
                if (message.getSym().equals("msg1")) {
                    msg1.add(message);
                } else if (message.getSym().equals("msg2")) {
                    msg2.add(message);
                }
        } catch (Exception e) {
                e.printStackTrace();
        }
    }

    public List&lt;BasicMessage&gt; getMsg1() {
        return msg1;
    }
    public List&lt;BasicMessage&gt; getMsg2() {
        return msg2;
    }
}

// 创建流表
conn.run("st11 = streamTable(100:0, `timestampv`id`blob`price1,[TIMESTAMP,INT,BLOB,DOUBLE])\n" +
                "enableTableShareAndPersistence(table=st11, tableName=`outTables, asynWrite=true, compress=true, cacheSize=200000, retentionMinutes=180, preCache = 0)\t\n");

Map&lt;String, Pair&lt;String, String&gt;&gt; tables = new HashMap&lt;&gt;();
StreamDeserializer streamFilter = new StreamDeserializer(tables, conn);
CustomHandler handler = new CustomHandler(streamFilter);
ThreadedClient client = new ThreadedClient(8848);
client.subscribe("192.168.0.21", 9002, "outTables", "mutiSchema", handler, 0, true);
conn.run("t = table(timestamp(1 2) as a,1 2 as b,blob(`a`b) as c,1.1 2.1 as d)\n" +
                "outTables.append!(t)");
List&lt;BasicMessage&gt; msg1 = handler.getMsg1();
List&lt;BasicMessage&gt; msg2 = handler.getMsg2();
client.unsubscribe("192.168.0.21", 9002, "outTables", "mutiSchema");</code></pre><ol class="- topic/ol ol"><li class="- topic/li li"><p class="- topic/p p">通过 <code class="+ topic/ph pr-d/codeph ph codeph">ThreadPooledClient</code> 订阅异构流表的方法和 <code class="+ topic/ph pr-d/codeph ph codeph">ThreadedClient</code> 一致。</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">指定 <code class="+ topic/ph pr-d/codeph ph codeph">subscribe</code> 函数的 <em class="+ topic/ph hi-d/i ph i">deserialize</em> 参数：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>CustomHandler handler = new CustomHandler(streamFilter);
ThreadPooledClient client1 = new ThreadPooledClient(9050, 10);
// client.subscribe(hostName, port, tableName, actionName, handler, 0, true);
// client.subscribe("192.168.0.21", 9002, "Trades", handler);
// client.subscribe("192.168.0.21", 9002, "outTables", "mutiSchema", handler, 0, true);
client.subscribe("192.168.0.21", 9002,"Trades1","subTread1", handler, -1, true, filter, streamFilter);</code></pre></li><li class="- topic/li li"><p class="- topic/p p">异构流表（streamFilter）也可以写入客户自定义的 Handler 中，在回调时被解析：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>CustomHandler handler = new CustomHandler(streamFilter);
ThreadPooledClient client = new ThreadPooledClient(9050, 10);
client.subscribe("192.168.0.21", 9002, "outTables", "mutiSchema", handler, 0, true);</code></pre></li></ul><p class="- topic/p p">由于 PollingClient 没有回调函数，只能通过为 <code class="+ topic/ph pr-d/codeph ph codeph">subscribe</code> 函数的 <em class="+ topic/ph hi-d/i ph i">deserialize</em> 参数传入 streamFilter 的方式进行解析：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code> ```
 PollingClient client = new PollingClient(9050);
 TopicPoller poller1 = client.subscribe("192.168.0.21", 9002, "Trades", "subTread1", 0, true, null, streamFilter,"","",true);
 ArrayList&lt;IMessage&gt; msg1;
 List&lt;String&gt; colNames =  Arrays.asList("tag","ts","data");
 List&lt;Vector&gt; colData = Arrays.asList(new BasicIntVector(0),new BasicTimestampVector(0),new BasicDoubleVector(0));
 BasicTable bt = new BasicTable(colNames,colData);
 conn.run("n=5000;t=table(1..n as tag,now()+1..n as ts,rand(100.0,n) as data);" +
         "Trades.append!(t)");
 msg1 = poller1.poll(1000, 10000);
 ```</code></pre></li></ol></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title11" id="取消订阅"><h2 class="- topic/title title topictitle2" id="ariaid-title11">取消订阅</h2><div class="- topic/body body"><p class="- topic/p p">停止订阅数据使用 <code class="+ topic/ph pr-d/codeph ph codeph">unsubscribe</code> 方法。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>public void unsubscribe(String host, int port, String tableName, String actionName)</code></pre><p class="- topic/p p">示例代码：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>client.unsubscribe("192.168.0.21", 9002, "outTables", "mutiSchema");</code></pre></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#%E4%B8%89%E7%A7%8D%E6%B5%81%E8%AE%A2%E9%98%85%E5%B7%A5%E5%85%B7%E7%9A%84%E6%9E%84%E9%80%A0%E6%96%B9%E5%BC%8F" data-tocid="三种流订阅工具的构造方式">三种流订阅工具的构造方式</a><ul><li class="topic-item"><a href="#threadedclient" data-tocid="threadedclient">ThreadedClient</a></li><li class="topic-item"><a href="#threadpooledclient" data-tocid="threadpooledclient">ThreadPooledClient</a></li><li class="topic-item"><a href="#pollingclient" data-tocid="pollingclient">PollingClient</a></li></ul></li><li class="topic-item"><a href="#%E4%B8%89%E7%A7%8D%E6%B5%81%E8%AE%A2%E9%98%85%E5%B7%A5%E5%85%B7%E7%9A%84%E8%AE%A2%E9%98%85%E6%96%B9%E5%BC%8F" data-tocid="三种流订阅工具的订阅方式">三种流订阅工具的订阅方式</a><ul><li class="topic-item"><a href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" data-tocid="示例代码">示例代码</a></li></ul></li><li class="topic-item"><a href="#%E9%87%8D%E8%BF%9E-reconnect" data-tocid="重连-reconnect">重连 reconnect</a></li><li class="topic-item"><a href="#%E5%90%AF%E7%94%A8-filter" data-tocid="启用-filter">启用 filter</a></li><li class="topic-item"><a href="#%E8%AE%A2%E9%98%85%E5%BC%82%E6%9E%84%E6%B5%81%E8%A1%A8" data-tocid="订阅异构流表">订阅异构流表</a></li><li class="topic-item"><a href="#%E5%8F%96%E6%B6%88%E8%AE%A2%E9%98%85" data-tocid="取消订阅">取消订阅</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2024 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>